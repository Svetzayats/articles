# Service workers in React App (CRA)

## Useful links

[Progressive Web App in CRA Documentation](https://create-react-app.dev/docs/making-a-progressive-web-app/)
[Use cases and recipes for Workbox](https://developer.chrome.com/docs/workbox/#use-cases-and-recipes)

## What is service workers?

Service workers are scripts that run in the background of a web page and provide features that don't require a web page or user interaction. In a Create React App project, service workers are implemented using the Workbox library, which makes it easy to add offline support to your app and improve the performance of your app by precaching resources. Note: resources that are not generated by webpack - for example, from /public - will not be precached.

> Workbox is a library that provides tools for adding offline support to web apps and improving the performance of web apps by precaching resources. It is designed to be easy to use and integrate with modern build tools and frameworks, such as webpack and Create React App. Workbox is developed and maintained by Google, and is used by a large number of web developers to build performant and reliable web apps.

## Pitfalls

There are a few potential pitfalls to be aware of when using service workers in a Create React App project:

- **Caching**: Service workers can improve the performance of your app by caching assets and serving them from the cache, but this can also lead to issues if the service worker is serving outdated assets.
  ⚠ You should make sure to update the service worker and the resources it caches whenever you make changes to your app.

- **Scope**: Service workers only have control over network requests that fall within their scope. In a Create React App project, the default scope is the root of the app, but you can specify a different scope if needed.
  ⚠ Be aware that if a service worker is registered with a narrow scope, it may not be able to intercept and handle requests for resources outside that scope.

- **Browser support**: Service workers are not supported in all browsers.  
  ⚠ You may need to provide a fallback for users on older browsers or those that don't support service workers.

- **Testing**: Testing service workers can also be difficult because they run in a separate thread and can be hard to access for testing purposes.
  ⚠ You should make sure to test your service worker code thoroughly to ensure that it is working as expected.

- **Debugging**: Debugging service workers can be challenging because they run in a separate thread and don't have access to the DOM. You can use the browser's developer tools to debug service workers, but it can still be tricky to track down issues.

## How to use in CRA

To use service workers in a Create React App project, you need to make sure that the register() function for the service worker is called from the root of your app.

## Customization

You can create service-worker.js (serviceWorker.ts) and change default behavior of the service worker in CRA project - for using additional modules from the Workbox project, adding notification library or changing some of the default caching logic:

1. Offline support: by default, the service worker generated by Create React App will only cache the assets that are required for the app to run offline. However, you may want to cache additional assets or data to make your app more functional offline.

2. Performance: the default service worker configuration for Create React App is designed to improve the performance of the app by caching assets and serving them from the cache. However, you may want to customize the service worker to use different caching strategies or cache additional resources to further improve the performance of your app.

3. Custom functionality: the default service worker for Create React App does not include any custom functionality beyond caching and offline support. You may want to change the behavior of the service worker to add additional features to your app, such as background sync or push notifications.
